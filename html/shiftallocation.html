<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>BSC Workshift Manager</title>
<link href="css/constant.css" rel="stylesheet" type="text/css" />
<link href="css/shiftallocation.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.5.0/jquery.min.js"></script>
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.9/jquery-ui.min.js"></script>
<script type="text/javascript">

	var shiftIsHighlighted = false;
	var highlightedShiftID = '';


	$( init );

	function init() {
		$('.resident').draggable({
			containment: '#content',
			snap: '.day',
			revert: true
		});
		
		$('.day').droppable({
			drop: handleResidentDrop
		});
		
		$('.resident').click(function() {
			if(shiftIsHighlighted) {
				var username = $(this).text();
				var newDiv = $('<div></div>').addClass('assignedResident').append(username);
				var closeButton = $('<span></span>').addClass('closeButton');
		
				closeButton.append('x');
				newDiv.append(closeButton);
				$('#'+highlightedShiftID).append(newDiv);
				$(this).remove();
		
				$(closeButton).click(function(event) {
					var replaceDiv = $('<div></div>').addClass('resident').append(username);
					newDiv.remove();
					$('#namelist').append(replaceDiv);
					$('.resident').draggable({
						containment: '#content',
						snap: '.day'
					});		
				});
			}
		});
		
		$('.day').click(function() {
			if ($(event.target).attr('class') == 'closeButton') {
				;
			} else if($(this).hasClass('highlighted')) {
				$(this).css('border', '1px solid #000000');
				$(this).css('background-color', '#FFBB99');
				$(this).removeClass('highlighted');
				shiftIsHighlighted = false;
			} else {
				if(shiftIsHighlighted) {
					$('#' + highlightedShiftID).removeClass('highlighted');
					$('#' + highlightedShiftID).css('border', '1px solid #000000');
					$('#' + highlightedShiftID).css('background-color', '#FFBB99');
				}
				$(this).css('border', '1px solid #0000DD');
				$(this).css('background-color', '#FFFFFF');
				$(this).addClass('highlighted');
				shiftIsHighlighted = true;
				highlightedShiftID = $(this).attr('id');
			}		
		});
	}
	
	function handleResidentDrop(event, ui) {
		var resident = ui.draggable;
		var username = resident.text();
		//var shift = ui.attr('id');
		var newDiv = $('<div></div>').addClass('assignedResident').append(username);
		var closeButton = $('<span></span>').addClass('closeButton');
		
		//make new assignment using username and shift
		
		closeButton.append('x');
		newDiv.append(closeButton);
		$(this).append(newDiv);
		resident.remove();
		
		$(closeButton).click(function(event) {
			var replaceDiv = $('<div></div>').addClass('resident').append(username);
			newDiv.remove();
			$('#namelist').append(replaceDiv);
			$('.resident').draggable({
				containment: '#content',
				snap: '.day',
				revert: true
			});
			//find the assignment corresponding to username and shift and delete it			
		}); 
	}	
	
</script>
</head>

<body>
<div id="wrap">
	<div id="main">
      <div id="header">
      	<span id="headertitle">
    		Berkeley Student Cooperative Workshift Manager
   		</span>
    	<span id="headerlist">
			<a class="headerlistitem" href="">Home</a>
        	<a class="headerlistitem" href="">Profile</a>
        	<a class="headerlistitem" href="">Logout</a>
   		</span>
      </div>
      <div id="logobar">
		<img id="logo" src="assets/BSC-logo-small.jpg" />
		<span id="logotext">Workshift Manager</span>
      </div>
      <div id="navbar">
		<ul id="navlist">
			<li><a class="navlistitem" href="">My Shifts</a><li>
        	<li><a class="navlistitem" href="">My Fines</a></li>
        	<li><a class="navlistitem" href="">Shift Preferences</a></li>
   		</ul>
      </div>
      <div id="content">
	  
		<!-- 
		
			Put content for different pages in this div! 
			
		-->
        <div id="content_header">
        	<h2>Shift Allocation</h2>
        </div>
        
        <!-- Chore creation field -->
        <div id="calendar">
       
			<div> Daily </div>
			<div id="daily">
              <span class="dayname">Monday</span>
			  <span class="dayname">Tuesday</span>
			  <span class="dayname">Wednesday</span>
			  <span class="dayname">Thursday</span>
			  <span class="dayname">Friday</span>
			  <span class="dayname">Saturday</span>
			  <span class="dayname">Sunday</span>
			</div>
			<div class="chore">
				<div class="chorename">Cook Breakfast</div>
				<div class="day monday" id="cookbreakfast"></div>
				<div class="day tuesday"></div>
				<div class="day wednesday"></div>
				<div class="day thursday"></div>
				<div class="day friday"></div>
				<div class="day saturday"></div>
				<div class="day sunday"></div>
			</div>
			<div class="chore">
				<div class="chorename">Breakfast Dishes</div>
				<div class="day monday"  id="breakfastdishes"></div>
				<div class="day tuesday"></div>
				<div class="day wednesday"></div>
				<div class="day thursday"></div>
				<div class="day friday"></div>
				<div class="day saturday"></div>
				<div class="day sunday"></div>
			</div>
			<div class="chore">
				<div class="chorename">Mop Kitchen Floor</div>
				<div class="day monday" id="mopkitchenfloor"></div>
				<div class="day tuesday"></div>
				<div class="day wednesday"></div>
				<div class="day thursday"></div>
				<div class="day friday"></div>
				<div class="day saturday"></div>
				<div class="day sunday"></div>
			</div>
			<div class="chore">
				<div class="chorename">Cook Lunch</div>
				<div class="day monday" id="cooklunch"></div>
				<div class="day tuesday"></div>
				<div class="day wednesday"></div>
				<div class="day thursday"></div>
				<div class="day friday"></div>
				<div class="day saturday"></div>
				<div class="day sunday"></div>
			</div>
			<div class="chore">
				<div class="chorename">Lunch Dishes</div>
				<div class="day monday" id="lunchdishes"></div>
				<div class="day tuesday"></div>
				<div class="day wednesday"></div>
				<div class="day thursday"></div>
				<div class="day friday"></div>
				<div class="day saturday"></div>
				<div class="day sunday"></div>
			</div>
    
        </div>
		
        <div id="namelist">
			<div id="namelisttitle"> Residents </div>
			<div class="resident">
				John Doe
			</div>
			<div class="resident">
				Jane Doe
			</div>
			<div class="resident">
				Harry Potter
			</div>
			<div class="resident">
				Hermione Granger
			</div>
			<div class="resident">
				Ron Weasley
			</div>
			<div class="resident">
				Ginny Weasley
			</div>
			<div class="resident">
				Draco Malfoy
			</div>
			<div class="resident">
				Dumbledore
			</div>
		</div>
      </div>
    
    <!-- End Main Content -->
      <div id="footer">
		<span id="footertext">(c) 2011 Team WSMA!!</span>
      </div>
	  <div id="spacer">
      </div>
	</div>
</div>

</body>
</html>
